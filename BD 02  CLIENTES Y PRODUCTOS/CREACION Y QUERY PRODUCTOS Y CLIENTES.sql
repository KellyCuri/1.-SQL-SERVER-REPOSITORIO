create database Tienda

create table Producto (
id_producto int not null primary key,
nombre varchar(70) not null,
despriccion  varchar (150) not null,
codigo_producto nvarchar(20) not null,
precio decimal (10,2)
);

create table Clientes (
id_cliente int not null primary key,
nombre_cliente varchar(70) not null,
producto_id  int not null,
fecha date not null,
cantidad int not null,
);

--- SUBIENDO DATOS EN TABLA CLIENTES
insert into Clientes (id_cliente, nombre_cliente, producto_id, fecha, cantidad, edad)   -- o INSER INTO [dbo].[Clientes]
values 
(110, 'MAYRA NOELIA ALMONACID RAMIREZ', 1, '2023-2-8', 3, 25),
(111, 'ROBERTO CARLOS SANTOS ANCAJIMA', 2, '2023-1-13', 2, 39),
(112, 'JORGE BHORIS URTEAGA PINEDO', 3, '2023-1-24', 3, 39),
(113, 'DIANA EDITH HUARANGA ASENCIOS', 4, '2023-2-25', 4, 36),
(114, 'CARLA GABRIELA CORNEJO MAMANI', 5, '2023-2-27', 3, 43),
(115, 'FRANCO GIOVANNI PORTOCARRERO CÁCERES', 6, '2023-2-27', 1, 21),
(116, 'SANTIAGO WALTER DEZA ESCUDERO', 7, '2023-1-7', 3, 27),
(117, 'JAVIER JUAREZ LLACSAHUANCA', 8, '2023-1-9', 1, 52),
(118, 'LUIS GUSTAVO PRECIADO MORAN', 9, '2023-1-25', 4, 25),
(119, 'JANET GIOVANA RICAPA ESTRELLA', 10, '2023-1-27', 2, 48),
(120, 'MARCO ANTONIO SULCA FERNÁNDEZ', 11, '2023-2-2', 4, 19),
(121, 'LUIS ALBERTO SEMINARIO RIVAS', 12, '2023-2-2', 3, 51),
(122, 'SEGUNDO ABELISARDO QUISPE CARHUAPOMA', 13, '2023-2-3', 4, 64),
(123, 'RAMON ANTONIO ARIAS VASQUEZ', 14, '2023-2-13', 2, 39),
(124, 'JHONATHAN EMMANUEL MONTALBAN OREJUELA', 15, '2023-2-21', 4, 27),
(125, 'MIRIAN JANET GUTIERREZ GONZALES', 16, '2023-2-22', 4, 20),
(126, 'JAVIER ALEJANDRO RAMOS CHUMACERO', 17, '2023-2-25', 3, 59),
(127, 'RICARDO PEREZ LANDAZURI', 18, '2023-1-6', 2, 48),
(128, 'OLIVER ROBERTS PALMA EFIO', 19, '2023-1-12', 1, 61),
(129, 'FIORELLA PAOLA ZEÑA SALDAÑA', 20, '2023-1-17', 4, 33),
(130, 'FLOR MARIA CERRADA CERRADA', 21, '2023-1-28', 4, 47),
(131, 'YULY EDITH BENANCIO BLANCO', 22, '2023-2-15', 3, 39),
(132, 'FERNANDO JAVIER QUIÑONES YAÑEZ', 23, '2023-1-3', 4, 33),
(133, 'OSCAR ANDRÉ CAMACHO CABALLERO', 24, '2023-1-3', 3, 50),
(134, 'LUIS ENRIQUE OSORIO AROAPAZA', 25, '2023-1-12', 4, 50),
(135, 'JUAN PABLO VASQUEZ CANALES', 26, '2023-1-16', 4, 59);


--- SUBIENDO DATOS EN TABLA PRODUCTO
insert into Producto(id_producto, nombre, despriccion, codigo_producto, precio)
values
( 1, '1 VENTILADOR 16 PULGADAS 3 EN 1 BLANCO 40W 220V', '1 VENTILADOR 16 PULGADAS 3 EN 1 BLANCO 40W 220V', 'SBLACC0014', 403),
( 2, '3M 6003 CARTUCHOS (FILTRO)CONTRA VAPORES ORGANICOS', '3M 6003 CARTUCHOS (FILTRO)CONTRA VAPORES ORGANICOS', 'MMMSEG0019', 464),
( 3, 'ABRAZADERA 1 UND W&C USA', 'ABRAZADERA 1 UND W&C USA', 'WATSUS0088', 704),
( 4, 'ABRAZADERA CUADRADA LEVANTE CAMION ZURLO', 'ABRAZADERA CUADRADA LEVANTE CAMION ZURLO', 'ZURSUS0006', 257),
( 5, 'ABRAZADERA DE ESCAPE 4"', 'ABRAZADERA DE ESCAPE 4"', 'ARCMOT0003', 449),
( 6, 'ABRAZADERA DE ESCAPE 4" CAMION AMERICANO USA', 'ABRAZADERA DE ESCAPE 4" CAMION AMERICANO USA', 'NELMOT0005', 512),
( 7, 'ABRAZADERA DE ESCAPE 5"', 'ABRAZADERA DE ESCAPE 5"', 'ARCMOT0001', 307),
( 8, 'ABRAZADERA DE ESCAPE 5" CAMION AMERICANO USA', 'ABRAZADERA DE ESCAPE 5" CAMION AMERICANO USA', 'NELMOT0006', 619),
( 9, 'ABRAZADERA MANGUERA DE TURBO AUTOMAN 3.75" a 4.06"', 'ABRAZADERA MANGUERA DE TURBO AUTOMAN 3.75" a 4.06"', 'ATMMAN0001', 723),
( 10, 'ABRAZADERA PAQUETE MUELLE 310 MM', 'ABRAZADERA PAQUETE MUELLE 310 MM', 'RANSUS0378', 842),
( 11, 'ABRAZADERA SUSP. TA300U09 CAMA BAJA W&C USA', 'ABRAZADERA SUSP. TA300U09 CAMA BAJA W&C USA', 'WATSUS0092', 763),
( 12, 'ABRAZADERA SUSPENSION TAS', 'ABRAZADERA SUSPENSION TAS', 'SPYSUS0025', 219),
( 13, 'ABRAZADERA TIPO U SUSP. MECANICA 3 1/2', 'ABRAZADERA TIPO U SUSP. MECANICA 3 1/2', 'BANSUS0007', 30),
( 14, 'ABRIDOR DE ENVASES', 'ABRIDOR DE ENVASES', 'MERSEG0115', 7),
( 15, 'ABRILLANTADOR DE LLANTAS 1GAL - BLACKSMIITH', 'ABRILLANTADOR DE LLANTAS 1GAL - BLACKSMIITH', 'BCKCAR0003', 124),
( 16, 'ABRILLANTADOR DE LLANTAS 5L TRUCK REPUBLIC', 'ABRILLANTADOR DE LLANTAS 5L TRUCK REPUBLIC', 'TRKCAR0102', 840),
( 17, 'ACEITE CAJA 80W90 GL-5 BALDE 5 GL INDIANA', 'ACEITE CAJA 80W90 GL-5 BALDE 5 GL INDIANA', 'INDLUB0007', 602),
( 18, 'ACEITE CAJA FEDERAL EXTRA GEAR LUBE 80W90 GL-5 balde', 'ACEITE CAJA FEDERAL EXTRA GEAR LUBE 80W90 GL-5 balde', 'FEDLUB0037', 750),
( 19, 'ACEITE CAJA FEDERAL SUPER GEAR LUBE 80W90 API GL-4 quarto', 'ACEITE CAJA FEDERAL SUPER GEAR LUBE 80W90 API GL-4 quarto', 'FEDLUB0019', 571),
( 20, 'ACEITE CORONA FEDERAL EXTRA GEAR LUBE 85W140 GL-5 balde', 'ACEITE CORONA FEDERAL EXTRA GEAR LUBE 85W140 GL-5 balde', 'FEDLUB0045', 424),
( 21, 'ACEITE CORONA INDIANA 85W140 GL5 BALDE X 5GL', 'ACEITE CORONA INDIANA 85W140 GL5 BALDE X 5GL', 'INDLUB0008', 99),
( 22, 'ACEITE DIESEL 15W40 CI-4 CHEVRON DELO GOLD ULTRAX', 'ACEITE DIESEL 15W40 CI-4 CHEVRON DELO GOLD ULTRAX', 'CHELUB3000', 736),
( 23, 'ACEITE DIESEL 15W40 CJ4 CHEVRON DELO 400 MGX BALDE', 'ACEITE DIESEL 15W40 CJ4 CHEVRON DELO 400 MGX BALDE', 'CHELUB0001', 473),
( 24, 'ACEITE DIESEL 25W60 CF4/SL BALDE 5 GL INDIANA', 'ACEITE DIESEL 25W60 CF4/SL BALDE 5 GL INDIANA', 'INDLUB0014', 47),
( 25, 'ACEITE DIESEL 25W60 CH4/SG 1/4GL INDIANA BLACK EDI', 'ACEITE DIESEL 25W60 CH4/SG 1/4GL INDIANA BLACK EDI', 'SBLLUB0024', 175),
( 26, 'ACEITE DIESEL FEDERAL FALCON 15W40 CI4/SL BALDE 5G', 'ACEITE DIESEL FEDERAL FALCON 15W40 CI4/SL BALDE 5G', 'FEDLUB0002', 546);


-- VALIDAR DATOS CREADOS DE LA TABLA
select * from Producto
select * from Clientes

-- SOLO ELIMINAR UNA FILA EN ESPECIFICO O VARIOS ID
DELETE FROM Clientes
WHERE id_cliente = 113;

DELETE FROM Clientes
WHERE id_cliente IN (110,111,112);


--- Inner Join 

SELECT a.nombre_cliente, b.despriccion, b.codigo_producto
FROM Clientes a, Producto b
where a.producto_id=b.id_producto

SELECT a.nombre_cliente, b.despriccion, b.codigo_producto
FROM Clientes a
INNER JOIN Producto b on a.producto_id = b.id_producto



---- Synonym para evitar tiempo en escribir el nombre largo de otra tabla:   CREATE SYNONYM MiSinonimo FOR dbo.MiTabla;
CREATE SYNONYM Clientito
for dbo.Clientes
go

select * from Clientito

-- VALIDAR QUE SIGA EN LA TABLA CLIENTES EL id_cliente = 113

SELECT * FROM Clientes
insert into Clientes (id_cliente, nombre_cliente, producto_id, fecha, cantidad, edad) values ( 113, 'DIANA EDITH HUARANGA ASENCIOS', 4, '2023-2-25', 4, 36);
SELECT * FROM Clientito

-- como definir tablas como tipo de datos, lo cual te servirá para crear estructuras en común en tus 
--procedimientos almacenados y funciones así como para poder enviar parámetros de tipo tabla.




-- COMO AGREGAR DATOS DE SOLO UNA COLUMNA SEGUN ID
UPDATE TABLA                    -- EJEMPLO TABLA PRODUCTO.V BD_VENDEDORES
SET TIPO_PRODUCTO = 
CASE 
WHEN ID = 2 THEN 'TERCEROS'
WHEN ID = 3 THEN 'TERCEROS'
WHEN ID = 4 THEN 'PROPIO'
WHEN ID = 5 THEN 'PROPIO'
WHEN ID = 6 THEN 'TERCEROS'
WHEN ID = 7 THEN 'TERCEROS'
WHEN ID = 8 THEN 'PROPIO'
WHEN ID = 9 THEN 'PROPIO'
WHEN ID = 10 THEN 'PROPIO'
ELSE TIPO_PRODUCTO  -- Mantener valores existentes para otros IDs
    END;


-- SOLO CAMBIAR UN VALOR EN ESPECIFICO (CELDA)
UPDATE [PRODUCTOS.V]
SET TIPO_PRODUCTO = 'PROPIO'
WHERE ID = 101 
